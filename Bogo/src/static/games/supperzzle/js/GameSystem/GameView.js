var __extends=this&&this.__extends||function(){var e=function(a,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var t in a)a.hasOwnProperty(t)&&(e[t]=a[t])})(a,t)};return function(a,t){function i(){this.constructor=a}e(a,t),a.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),GameView=function(e){function a(){var a=e.call(this)||this;return a.mGameMode=null,a.checkerboard=null,a.mPatternList=[],a.width=Laya.stage.width,a.height=Laya.stage.height,a.Init(),a}return __extends(a,e),a.prototype.Init=function(){var e=this;MessageProxy.Instance().SendLoadReady(),this.checkerboard=new Laya.View;var a=[];this.mGameMode=ControllerManage.Instance().mGameController.mGameMode,this.mGameMode.checkerboard=[];for(var t=0;t<this.mGameMode.horizontalCount;t++){for(var i=[],n=0;n<this.mGameMode.verticalCount;n++){var o=new GamePattern;i[n]=o,this.checkerboard.addChild(o),o.Init(t,n),0==t||0==n||t==this.mGameMode.horizontalCount-1||n==this.mGameMode.verticalCount-1?o.SetEmpty():(this.mPatternList.push(o),a.push(o))}this.mGameMode.checkerboard[t]=i}for(this.candySum=a.length;a.length>0;){var s="Icon/"+Common.Random(7)+".png",h=a[Common.Random(a.length-1)];a.splice(a.indexOf(h),1);var r=a[Common.Random(a.length-1)];1==a.length&&(r=a[0]),a.splice(a.indexOf(r),1),h.SetIcon(s),r.SetIcon(s),h.isClear=!0,r.isClear=!0}this.checkerboard.centerX=0,this.checkerboard.centerY=0,this.addChild(this.checkerboard);var d=new Dialog;d.width=Laya.stage.width,d.height=Laya.stage.height,this.addChild(d),this.imgReady=new Laya.Image,this.imgReady.skin="Frame/ready.png",this.imgReady.pos(Laya.stage.width/2-this.imgReady.width/2,Laya.stage.height/2-this.imgReady.height/2),Laya.timer.once(1e3,this,function(){e.imgReady.scale(2.5,2.5),e.imgReady.skin="Frame/go.png",e.imgReady.pos(Laya.stage.width/2,Laya.stage.height/2),e.imgReady.pivot(e.imgReady.width/2,e.imgReady.height/2),Laya.Tween.to(e.imgReady,{scaleX:1,scaleY:1},100)}),this.addChild(this.imgReady),Laya.SoundManager.playSound("sounds/readyGo.mp3",1,Laya.Handler.create(this,function(){e.imgReady.visible=!1,e.imgReady.scale(1,1),e.imgReady.pos(Laya.stage.width/2,Laya.stage.height/2),e.imgReady.pivot(e.imgReady.width/2,e.imgReady.height/2),e.imgReady.visible=!0,Laya.Tween.to(e.imgReady,{scaleX:1.2,scaleY:1.2},100,null,Laya.Handler.create(e,function(){e.imgReady.visible=!1,d.removeSelf(),Laya.SoundManager.playMusic("sounds/happyMisic2.mp3",0)})),MessageProxy.Instance().SendGameReady()})),this.SetScore(0,.01),this.SetScore(1,.01),Laya.timer.once(2e3,this,function(){e.imgReady.removeSelf(),d.removeSelf()}),Laya.stage.on(Laya.Event.VISIBILITY_CHANGE,this,function(){Laya.stage.isVisibility?Laya.SoundManager.playMusic("sounds/happyMisic2.mp3",0):Laya.SoundManager.stopMusic()})},a.prototype.musicComplete=function(e,a){e.removeSelf(),a.removeSelf(),Laya.SoundManager.playMusic("sounds/happyMisic2.mp3",0)},a.prototype.SetScore=function(e,a){0==e?(this.clip_pb1.visible=!0,this.clip_pb1.clipWidth=162*a,console.log(this.clip_pb1.clipWidth)):(this.clip_pb2.visible=!0,this.clip_pb2.clipWidth=162*a,console.log(this.clip_pb2.clipWidth))},a}(ui.GameUI.GameUI);