var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();!function(){function e(t,i,a){function n(s,r){if(!i[s]){if(!t[s]){var p="function"==typeof require&&require;if(!r&&p)return p(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var y=i[s]={exports:{}};t[s][0].call(y.exports,function(e){return n(t[s][1][e]||e)},y,y.exports,e,t,i,a)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<a.length;s++)n(a[s]);return n}return e}()({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});!function(e){e[e.start_game=0]="start_game",e[e.preLoad_complete=1]="preLoad_complete",e[e.preLoad_progress=2]="preLoad_progress",e[e.enter_game=3]="enter_game",e[e.over_game=4]="over_game",e[e.game=5]="game",e[e.net_update_jump=6]="net_update_jump",e[e.net_update_score=7]="net_update_score",e[e.net_user_info=8]="net_user_info"}(i.EventEnum||(i.EventEnum={}))},{}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(){}return e.init=function(){Laya.ClassUtils.regClass},e.width=640,e.height=1136,e.scaleMode="fixedwidth",e.screenMode="none",e.alignV="top",e.alignH="left",e.startScene="GameView.scene",e.sceneRoot="",e.debug=!1,e.stat=!1,e.physicsDebug=!1,e.exportSceneToJson=!0,e}();i.default=a,a.init()},{}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("../manage/EventManage"),n=e("../Enum/EventEnum"),o=function(){function e(){this.AddListener()}return e.prototype.AddListener=function(){a.EventManage.Instance().AddListener(n.EventEnum.over_game,this.GameOver.bind(this))},e.prototype.GameOver=function(e){},e.prototype.startAnimation=function(){Laya.timer.frameLoop(1,this,this.loopAnimate)},e.prototype.loopAnimate=function(){},e}();i.GameOverController=o},{"../Enum/EventEnum":1,"../manage/EventManage":14}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(){}return e.randomNum=function(e,t){return e+Math.round((t-e)*Math.random())},e.GameWidth=750,e.GameHeight=1334,e.BlockDistanceX=0,e.FloorHeight=1292,e.FloorBottomHeight=757,e.speed=50,e.SPEED_FAST=60,e.isPause=!1,e.isOver=!0,e.imgPrev="ui/",e}();i.default=a},{}],5:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("../Enum/EventEnum"),n=e("../manage/EventManage"),o=e("../manage/GameManage"),s=e("./GameView"),r=e("./Player1"),p=e("./GameCfg"),l=e("./Player2"),y=e("./Role"),h=e("../MessageProxy"),u=function(){function e(){this.jumpDisable=!0,this.is1PWin=0,this.isHit=!1,this.hp=3,this.hp2=3,this.bulletType=0,this.round=0,this.bulletPos=[[15,15],[-25,-25,45,45],[-55,-55,15,15,85,85]],this.isMe=!0,this.sp=new Laya.Sprite,this.roleAni=new Laya.Animation,this.AddListener()}return e.prototype.AddListener=function(){n.EventManage.Instance().AddListener(a.EventEnum.preLoad_complete,this.EnterGame.bind(this)),n.EventManage.Instance().AddListener(a.EventEnum.net_update_score,this.NetUpdateScore.bind(this)),n.EventManage.Instance().AddListener(a.EventEnum.net_user_info,this.NetUserInfo.bind(this)),n.EventManage.Instance().AddListener(a.EventEnum.net_update_jump,this.NetUserJump.bind(this))},e.prototype.EnterGame=function(){this.mGameView=new s.GameView,o.GameManage.Instance().mRoot.addChild(this.mGameView),this.init()},e.prototype.init=function(){h.MessageProxy.Instance().SendGameReady(),this.roleBox=new Laya.Sprite,Laya.stage.addChild(this.roleBox),this.player1=r.default.Default,this.player2=l.default.Default,this.roleBox.addChild(this.player1),this.roleBox.addChild(this.player2),this.readyGo()},e.prototype.restart=function(){var e=this;switch(this.round++,this.isHit=!1,this.is1PWin=0,this.jumpDisable=!1,this.time=30,this.player1.getImg().visible=!1,this.player2.getImg().visible=!1,this.player1.isBullet=0,this.player2.isBullet=0,this.player1.gotoStand(),this.player2.gotoStand(),this.player2.getImg().visible=!1,this.imgReady.scale(1,1),this.round){case 1:this.imgReady.skin="ui/first_round.png";break;case 2:this.imgReady.skin="ui/second_round.png";break;case 3:this.imgReady.skin="ui/third_round.png";break;case 4:this.imgReady.skin="ui/fourth_round.png";break;case 5:this.imgReady.skin="ui/fifth_round.png";break;default:this.imgReady.skin="ui/first_round.png"}this.imgReady.pos(Laya.stage.width/2,Laya.stage.height/2),this.imgReady.pivot(this.imgReady.width/2,this.imgReady.height/2),this.imgReady.visible=!0,Laya.Tween.to(this.imgReady,{scaleX:1.2,scaleY:1.2},500,null,Laya.Handler.create(this,function(){e.imgReady.visible=!1})),Laya.Tween.to(this.mGameView.img_vblock,{rotation:90},300),this.mGameView.txt_time.text=this.time+"",Laya.timer.loop(1e3,this,this.countDownTimer);for(var t=this.roleBox.numChildren-1;t>-1;t--){var i=this.roleBox.getChildAt(t);4!=i.type&&5!=i.type||(i.visible=!1)}this.mGameView.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.timer.frameLoop(1,this,this.onLoop),Laya.timer.loop(1500,this,this.shoot),this.isRobot&&Laya.timer.loop(500,this,this.robotJump)},e.prototype.robotJump=function(){var e=this;Laya.timer.once(p.default.randomNum(1,2500),this,function(){e.jumpDisable||e.player2.jump()})},e.prototype.gameOver=function(){Laya.timer.clear(this,this.countDownTimer),this.jumpDisable=!0,Laya.Tween.to(this.mGameView.img_vblock,{rotation:0},300),0==this.hp||0==this.hp2||Laya.timer.once(3500,this,this.restart),this.isRobot&&Laya.timer.clear(this,this.robotJump)},e.prototype.clearHP=function(e,t){if(!(t<0||t>2)){var i=e.getChildByName("hp"+t);laya.utils.Tween.to(i,{scaleX:1.2,scaleY:1.2,alpha:.2},1e3,Laya.Ease.linearOut,Laya.Handler.create(this,function(){i.skin="ui/hp0.png",laya.utils.Tween.to(i,{scaleX:1,scaleY:1,alpha:1},1e3,Laya.Ease.linearOut)}))}},e.prototype.countDownTimer=function(){if(this.time-=1,this.mGameView.txt_time.text=this.time+"",0==this.time&&this.isMe&&(this.jumpDisable=!0,h.MessageProxy.Instance().SendPostScore(this.hp-1),h.MessageProxy.Instance().SendBroadCast({type:"die1P"}),this.Player2DIE(),this.clearHP(this.mGameView.hp_player2,this.hp2),h.MessageProxy.Instance().SendBroadCast({type:"die2P"})),this.time%6==0){if(!this.isMe)return;Math.random()>.5?h.MessageProxy.Instance().SendBroadCast({type:"fanghuzhao",y:p.default.randomNum(313,1083)}):h.MessageProxy.Instance().SendBroadCast({type:"paodan",y:p.default.randomNum(313,1083)})}},e.prototype.readyGo=function(){var e=this;this.imgReady=new Laya.Image,this.imgReady.skin="ui/ready.png",this.imgReady.pos(Laya.stage.width/2-this.imgReady.width/2,Laya.stage.height/2-this.imgReady.height/2),Laya.timer.once(1e3,this,function(){e.imgReady.scale(2.5,2.5),e.imgReady.skin="ui/go.png",e.imgReady.pos(Laya.stage.width/2,Laya.stage.height/2),e.imgReady.pivot(e.imgReady.width/2,e.imgReady.height/2),Laya.Tween.to(e.imgReady,{scaleX:1,scaleY:1},100)}),this.mGameView.addChild(this.imgReady),Laya.SoundManager.playSound("sounds/readyGo.mp3",1,Laya.Handler.create(this,function(){e.imgReady.visible=!1,p.default.isOver=!1,e.restart()})),Laya.SoundManager.playMusic("sounds/bg.mp3",0)},e.prototype.onLoop=function(){this.player1.y>p.default.FloorHeight&&(this.player1.y=p.default.FloorHeight,1==this.is1PWin?this.player1.gotoWin():2==this.is1PWin?this.player1.gotoDieFloor():this.player1.gotoStand()),this.player2.y>p.default.FloorHeight&&(this.player2.y=p.default.FloorHeight,1==this.is1PWin?this.player2.gotoDieFloor():2==this.is1PWin?this.player2.gotoWin():this.player2.gotoStand());for(t=this.roleBox.numChildren-1;t>-1;t--){var e=this.roleBox.getChildAt(t);e&&(e.x+=e.speed,0!=e.propShootType&&(2==e.camp?e.y+=this.sp.x*e.propShootType*-1:e.y+=this.sp.x*e.propShootType,e.rotation=55*this.sp.x/12*e.propShootType),(e.x>1500||!e.visible||e.x<-100)&&(e.removeSelf(),e.visible=!0,e.rotation=0,e.scaleX=1,e.scaleY=1,Laya.Pool.recover("role",e)))}for(var t=this.roleBox.numChildren-1;t>-1;t--)for(var i=this.roleBox.getChildAt(t),a=t-1;a>-1;a--){if(1==this.is1PWin||2==this.is1PWin)return;if(i.visible){var n=this.roleBox.getChildAt(a);if(i.camp!=n.camp){var o=i.hitRadius+n.hitRadius;Math.abs(i.x-n.x)<o&&Math.abs(i.y-n.y)<o&&(this.lostHp(i,n),this.lostHp(n,i))}}}},e.prototype.Player1DIE=function(){this.is1PWin=2,this.player1.gotoDie(),this.gameOver(),this.hp--,this.bulletType=3-this.hp},e.prototype.Player2DIE=function(){this.is1PWin=1,this.player2.gotoDie(),this.gameOver(),this.hp2--,this.bulletType=3-this.hp2},e.prototype.lostHp=function(e,t){if(3==e.type)e.visible=!1;else if(1==e.type){Laya.SoundManager.playSound("sounds/hit.mp3");(i=this.player1.getImg()).visible?i.visible=!1:this.isMe&&!this.isHit&&(this.isHit=!0,h.MessageProxy.Instance().SendPostScore(this.hp-1),this.jumpDisable=!0,h.MessageProxy.Instance().SendBroadCast({type:"die1P"}))}else if(2==e.type){Laya.SoundManager.playSound("sounds/hit.mp3");var i=this.player2.getImg();i.visible?i.visible=!1:this.isMe&&!this.isHit&&(this.isHit=!0,this.Player2DIE(),this.clearHP(this.mGameView.hp_player2,this.hp2),this.isRobot?h.MessageProxy.Instance().SendPostScore(this.hp2,this.uid2p):h.MessageProxy.Instance().SendBroadCast({type:"die2P"}))}else 4==e.type?(e.visible=!1,1==t.camp?this.player1.getImg().visible=!0:this.player2.getImg().visible=!0):5==e.type&&(e.visible=!1,1==t.camp?this.player1.setIsBullet(1):this.player2.setIsBullet(1))},e.prototype.onMouseDown=function(){p.default.isOver||this.jumpDisable||(this.isMe?h.MessageProxy.Instance().SendBroadCast({type:"jump1"}):h.MessageProxy.Instance().SendBroadCast({type:"jump2"}))},e.prototype.shoot=function(){if(!p.default.isOver&&!this.jumpDisable){this.player1.gotoShoot(),this.player2.gotoShoot(),Laya.SoundManager.playSound("sounds/paodan.mp3"),this.sp.x=0,0==this.player1.isBullet&&0==this.player2.isBullet||(Laya.Tween.to(this.sp,{x:9},1100,Laya.Ease.quadOut),this.player1.y>this.player2.y&&0!=this.player1.isBullet?this.player1.isBullet=-1:this.player1.y<this.player2.y&&0!=this.player1.isBullet&&(this.player1.isBullet=1),this.player1.y>this.player2.y&&0!=this.player2.isBullet?this.player2.isBullet=-1:this.player1.y<this.player2.y&&0!=this.player2.isBullet&&(this.player2.isBullet=1)),(this.bulletType>2||this.bulletType<0)&&(this.bulletType=0);for(var e=this.bulletPos[this.bulletType],t=0;t<e.length;t++){var i=Laya.Pool.getItemByClass("role",y.Role);i.pivot(52,34),t%2==1?(i.loadImage("ui/p1paodan.png"),i.init(3,10,1,this.player1.isBullet,29),i.pos(this.player1.x+125,this.player1.y+e[t])):(i.loadImage("ui/p2paodan.png"),i.init(3,-10,2,this.player2.isBullet,29),i.pos(this.player2.x-125,this.player2.y+e[t])),i.scale(.85,.85),this.roleBox.addChild(i)}}},e.prototype.aniUrls=function(e,t){for(var i=[],a=0;a<t;a++)i.push("ui/"+e+(a+1)+".png");return i},e.prototype.NetUpdateScore=function(e){console.log(e),this.isMe?e.id>0||(this.Player1DIE(),this.clearHP(this.mGameView.hp_player1,this.hp)):e.id>0||(this.Player2DIE(),this.clearHP(this.mGameView.hp_player2,this.hp2))},e.prototype.NetUserInfo=function(e){var t=this;console.log(e.data),this._users=e,null!=this.mGameView&&(1!=this._users.data[0].isRobot&&1!=this._users.data[1].isRobot?this._users.data[0].userId<this._users.data[1].userId?this.isMe=!0:this.isMe=!1:1==this._users.data[1].isRobot&&(this.isRobot=!0,this.isMe=!0),this.isMe&&(this.uid1p=this._users.data[0].userId,this.uid2p=this._users.data[1].userId),this.mGameView.player1_name.text=e.data[0].userName,this.mGameView.player2_name.text=e.data[1].userName,this.mGameView.player1_icon.skin=e.data[0].userHead,this.mGameView.player2_icon.skin=e.data[1].userHead,this.mGameView.p1_head_border.skin=e.data[0].userHeadFrame,this.mGameView.p2_head_border.skin=e.data[1].userHeadFrame,this.roleAni.loadImages(this.aniUrls("me000",7)),this.isMe?this.roleAni.pos(121,1109):this.roleAni.pos(398,1109),this.mGameView.addChild(this.roleAni),this.roleAni.play(null,!0),Laya.timer.once(2e3,this,function(){t.roleAni.removeSelf()}))},e.prototype.NetUserJump=function(e){switch(e.type){case"jump2":this.jumpDisable||this.player2.jump();break;case"jump1":this.jumpDisable||this.player1.jump();break;case"die1P":this.isMe||(this.Player1DIE(),this.clearHP(this.mGameView.hp_player1,this.hp));break;case"die2P":this.isMe||h.MessageProxy.Instance().SendPostScore(this.hp2-1);break;case"fanghuzhao":var t=new y.Role;t.loadImage("ui/p_fanghuzhao.png"),t.init(4,0,3,0,53),t.pivot(t.width>>1,t.height>>1),t.pos(374,e.y),this.roleBox.addChild(t);break;case"paodan":var i=new y.Role;i.loadImage("ui/p_paodan.png"),i.init(5,0,3,0,53),i.pivot(i.width>>1,i.height>>1),i.pos(374,e.y),this.roleBox.addChild(i)}},e}();i.GameController=u},{"../Enum/EventEnum":1,"../MessageProxy":11,"../manage/EventManage":14,"../manage/GameManage":15,"./GameCfg":4,"./GameView":6,"./Player1":7,"./Player2":8,"./Role":9}],6:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e("../ui/layaMaxUI").ui.GameViewUI);i.GameView=a},{"../ui/layaMaxUI":17}],7:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./GameCfg"),n=laya.ui.Image,o=laya.display.Animation,s=laya.utils.Tween,r=laya.utils.Handler,p=function(e){function t(){var t=e.call(this)||this;return t.vy=0,t.downSpeed=.4,t.maxVy=40,t.maxY=311,t.hp=3,e.prototype.init.call(t,1,0,1,0,70),t.init(),t}return __extends(t,e),Object.defineProperty(t,"Default",{get:function(){return null==this._defualt&&(this._defualt=new t),this._defualt},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.x=112,this.y=a.default.FloorHeight,t.cached||(t.cached=!0,o.createFrames(["player/j_die0001.png","player/j_die0002.png","player/j_die0003.png","player/j_die0004.png","player/j_die0005.png","player/j_die0006.png","player/j_die0007.png"],t.DIE),o.createFrames(["player/j_flyidle.png"],t.FLY),o.createFrames(["player/j_stand.png"],t.STAND),o.createFrames(["player/j_atk0001.png","player/j_atk0002.png","player/j_atk0003.png","player/j_atk0004.png","player/j_atk0005.png","player/j_flyidle.png"],t.SHOOT),o.createFrames(["player/j_atk0001.png","player/j_atk0002.png","player/j_atk0003.png","player/j_atk0004.png","player/j_atk0005.png","player/j_stand.png"],t.SHOOTFLOOR),o.createFrames(["ui/jituiwan.png"],t.DIE_FLOOR),o.createFrames(["player/j_flyup0001.png","player/j_flyup0002.png","player/j_flyup0003.png","player/j_flyup0004.png","player/j_flyup0005.png"],t.JUMP),o.createFrames(["player/j_vic0001.png","player/j_vic0002.png","player/j_vic0003.png","player/j_vic0004.png","player/j_vic0005.png","player/j_vic0006.png","player/j_vic0007.png","player/j_vic0008.png","player/j_vic0009.png","player/j_vic0010.png","player/j_vic0011.png","player/j_vic0012.png","player/j_vic0013.png","player/j_vic0014.png","player/j_vic0015.png","player/j_vic0016.png","player/j_vic0017.png","player/j_vic0018.png","player/j_vic0019.png","player/j_vic0020.png","player/j_vic0021.png","player/j_vic0022.png","player/j_vic0023.png","player/j_vic0024.png","player/j_vic0025.png","player/j_vic0026.png","player/j_vic0027.png","player/j_vic0028.png","player/j_vic0029.png","player/j_vic0030.png","player/j_vic0031.png","player/j_vic0032.png","player/j_vic0033.png","player/j_vic0034.png","player/j_vic0035.png","player/j_vic0036.png","player/j_vic0037.png","player/j_vic0038.png","player/j_vic0039.png","player/j_vic0040.png"],t.WIN)),null==this.body&&(this.body=new o,this.body.pivot(91.5,70),this.body.interval=50,this.addChild(this.body)),this.img=new n,this.img.skin="ui/fanghuzhao.png",this.img.pivot(69,69),this.img.visible=!1,this.addChild(this.img),this.img.scale(1.1,1.1),this.playAction(t.STAND),Laya.timer.frameLoop(1,this,this.onLoop)},t.prototype.getImg=function(){return this.img},t.prototype.playAction=function(e){this.action=e,e==t.WIN?(this.body.pivot(91.5,92.5),this.body.play(0,!1,this.action)):e==t.DIE_FLOOR?(this.body.pivot(60.5,25.5),this.body.play(0,!1,this.action)):(this.body.pivot(91.5,70),this.body.play(0,!1,this.action))},t.prototype.onLoop=function(){a.default.isOver||(this.y<a.default.FloorHeight&&(this.y+=this.vy,this.vy+=this.downSpeed),this.vy>this.maxVy&&(this.vy=this.maxVy),this.y<this.maxY&&(this.y=this.maxY,this.y+=this.vy,this.vy+=this.downSpeed))},t.prototype.gotoJump=function(){this.playAction(t.JUMP)},t.prototype.gotoFly=function(){this.playAction(t.FLY)},t.prototype.gotoStand=function(){this.playAction(t.STAND)},t.prototype.gotoWin=function(){this.playAction(t.WIN)},t.prototype.gotoDieFloor=function(){this.playAction(t.DIE_FLOOR)},t.prototype.gotoShoot=function(){this.y==a.default.FloorHeight?this.playAction(t.SHOOTFLOOR):this.playAction(t.SHOOT)},t.prototype.gotoDie=function(){this.playAction(t.DIE),this.y==a.default.FloorHeight&&this.playAction(t.DIE_FLOOR)},t.prototype.jump=function(){this.y==a.default.FloorHeight&&(this.y=a.default.FloorHeight-1),this.vy=-13,this.gotoJump()},t.prototype.jumpReset=function(){this.vy=0,this.gotoFly()},t.prototype.getAction=function(){return this.action},t.prototype.showEffect=function(){a.default.isPause=!0,a.default.speed=a.default.SPEED_FAST,this.spiritEffect.visible=!0,s.to(this.spiritEffect,{scaleX:.1,scaleY:.1,rotation:360},1e3,null,r.create(this,this.spiritEffectTweenComplete))},t.prototype.spiritEffectTweenComplete=function(){this.spiritEffect.visible=!1,this.spiritEffect.scale(5,5),a.default.isPause=!1},t.SHOOT="player_attack",t.SHOOTFLOOR="player_floor",t.HIT="player_hit",t.JUMP="player_jump",t.DIE="player_die",t.STAND="player_stand",t.FLY="player_fly",t.WIN="player_win",t.DIE_FLOOR="player_die_floor",t.cached=!1,t}(e("./Role").Role);i.default=p},{"./GameCfg":4,"./Role":9}],8:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./GameCfg"),n=laya.ui.Image,o=laya.display.Animation,s=laya.utils.Tween,r=laya.utils.Handler,p=function(e){function t(){var t=e.call(this)||this;return t.vy=0,t.downSpeed=.4,t.maxVy=40,t.maxY=311,t.hp=3,e.prototype.init.call(t,2,0,2,0,70),t.init(),t}return __extends(t,e),Object.defineProperty(t,"Default",{get:function(){return null==this._defualt1&&(this._defualt1=new t),this._defualt1},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.width=180,this.height=140,this.x=640,this.y=a.default.FloorHeight,t.cached||(t.cached=!0,o.createFrames(["player/t_die0001.png","player/t_die0002.png","player/t_die0003.png","player/t_die0004.png","player/t_die0005.png","player/t_die0006.png","player/t_die0007.png"],t.DIE),o.createFrames(["player/t_flyidle.png"],t.FLY),o.createFrames(["player/t_stand.png"],t.STAND),o.createFrames(["player/t_atk0001.png","player/t_atk0002.png","player/t_atk0003.png","player/t_atk0004.png","player/t_atk0005.png","player/t_flyidle.png"],t.SHOOT),o.createFrames(["player/t_atk0001.png","player/t_atk0002.png","player/t_atk0003.png","player/t_atk0004.png","player/t_atk0005.png","player/t_stand.png"],t.SHOOTFLOOR),o.createFrames(["player/t_flyup0001.png","player/t_flyup0002.png","player/t_flyup0003.png","player/t_flyup0004.png","player/t_flyup0005.png"],t.JUMP),o.createFrames(["ui/jituiwan2.png"],t.DIE_FLOOR),o.createFrames(["player/t_vic0001.png","player/t_vic0002.png","player/t_vic0003.png","player/t_vic0004.png","player/t_vic0005.png","player/t_vic0006.png","player/t_vic0007.png","player/t_vic0008.png","player/t_vic0009.png","player/t_vic0010.png","player/t_vic0011.png","player/t_vic0012.png","player/t_vic0013.png","player/t_vic0014.png","player/t_vic0015.png","player/t_vic0016.png","player/t_vic0017.png","player/t_vic0018.png","player/t_vic0019.png","player/t_vic0020.png","player/t_vic0021.png","player/t_vic0022.png","player/t_vic0023.png","player/t_vic0024.png","player/t_vic0025.png","player/t_vic0026.png","player/t_vic0027.png","player/t_vic0028.png","player/t_vic0029.png","player/t_vic0030.png","player/t_vic0031.png","player/t_vic0032.png","player/t_vic0033.png","player/t_vic0034.png","player/t_vic0035.png","player/t_vic0036.png","player/t_vic0037.png","player/t_vic0038.png","player/t_vic0039.png","player/t_vic0040.png"],t.WIN)),null==this.body&&(this.body=new o,this.body.pivot(90,70),this.body.interval=50,this.addChild(this.body)),this.img=new n,this.img.skin="ui/fanghuzhao.png",this.img.pivot(69,69),this.img.visible=!1,this.addChild(this.img),this.img.scale(1.1,1.1),this.playAction(t.STAND),Laya.timer.frameLoop(1,this,this.onLoop)},t.prototype.getImg=function(){return this.img},t.prototype.playAction=function(e){this.action=e,e==t.WIN?(this.body.pivot(91.5,92.5),this.body.play(0,!1,this.action)):e==t.DIE_FLOOR?(this.body.pivot(60.5,25.5),this.body.play(0,!1,this.action)):(this.body.pivot(91.5,70),this.body.play(0,!1,this.action))},t.prototype.onLoop=function(){a.default.isOver||(this.y<a.default.FloorHeight&&(this.y+=this.vy,this.vy+=this.downSpeed),this.vy>this.maxVy&&(this.vy=this.maxVy),this.y<this.maxY&&(this.y=this.maxY,this.y+=this.vy,this.vy+=this.downSpeed))},t.prototype.gotoJump=function(){this.playAction(t.JUMP)},t.prototype.gotoFly=function(){this.playAction(t.FLY)},t.prototype.gotoStand=function(){this.playAction(t.STAND)},t.prototype.gotoWin=function(){this.playAction(t.WIN)},t.prototype.gotoShoot=function(){this.y==a.default.FloorHeight?this.playAction(t.SHOOTFLOOR):this.playAction(t.SHOOT)},t.prototype.gotoDieFloor=function(){this.playAction(t.DIE_FLOOR)},t.prototype.gotoDie=function(){this.playAction(t.DIE),this.y==a.default.FloorHeight&&this.playAction(t.DIE_FLOOR)},t.prototype.jump=function(){this.y==a.default.FloorHeight&&(this.y=a.default.FloorHeight-1),this.vy=-13,this.gotoJump()},t.prototype.jumpReset=function(){this.vy=0,this.gotoFly()},t.prototype.getAction=function(){return this.action},t.prototype.showEffect=function(){a.default.isPause=!0,a.default.speed=a.default.SPEED_FAST,this.spiritEffect.visible=!0,s.to(this.spiritEffect,{scaleX:.1,scaleY:.1,rotation:360},1e3,null,r.create(this,this.spiritEffectTweenComplete))},t.prototype.spiritEffectTweenComplete=function(){this.spiritEffect.visible=!1,this.spiritEffect.scale(5,5),a.default.isPause=!1},t.SHOOT="player_attack1",t.SHOOTFLOOR="player_floor1",t.HIT="player_hit1",t.JUMP="player_jump1",t.DIE="player_die1",t.STAND="player_stand1",t.FLY="player_fly1",t.WIN="player_win1",t.DIE_FLOOR="player_die_floor1",t.cached=!1,t}(e("./Role").Role);i.default=p},{"./GameCfg":4,"./Role":9}],9:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(e){function t(){var t=e.call(this)||this;return t.isBullet=0,t}return __extends(t,e),t.prototype.init=function(e,t,i,a,n){this.type=e,this.speed=t,this.camp=i,this.propShootType=a,this.hitRadius=n},t.prototype.addProp=function(e){this.propShootType=e},t.prototype.setIsBullet=function(e){this.isBullet=e},t}(Laya.Sprite);i.Role=a},{}],10:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./GameConfig"),n=e("./manage/GameManage");new(function(){return function(){this.stageWidth=750,this.stageHeight=1500,Config.isAlpha=!0,window.Laya3D?Laya3D.init(this.stageWidth,this.stageHeight):Laya.init(this.stageWidth,this.stageHeight,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.stage.bgColor=null,Laya.stage.scaleMode=Laya.Stage.SCALE_NOBORDER,Laya.stage.screenMode=Laya.Stage.SCREEN_VERTICAL,Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.stage.alignV=Laya.Stage.ALIGN_MIDDLE,Laya.URL.exportSceneToJson=a.default.exportSceneToJson,Laya.alertGlobalError=!0,n.GameManage.Instance().StartGame()}}())},{"./GameConfig":2,"./manage/GameManage":15}],11:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=Laya.Browser,n=e("./manage/GameManage"),o=function(){function e(){}return e.Instance=function(){return null==this.s_instance&&(this.s_instance=new e),this.s_instance},e.prototype.InitProxy=function(){var e=this;a.window.addEventListener("message",function(t){e.OnReceiveMessage(t.data)}),this._users=[]},e.prototype.PostMessage=function(e){a.window.parent&&a.window.parent.postMessage(e,"*")},e.prototype.SendPostScore=function(e,t){this.PostMessage({cmd:"SendGameData",data:e,uid:t})},e.prototype.SendBroadCast=function(e){this.PostMessage({cmd:"BroadCastData",data:e})},e.prototype.SendGameReady=function(){this.PostMessage({cmd:"GameLoadReady"})},e.prototype.SendGameOver=function(){this.PostMessage({cmd:"GameOver"})},e.prototype.AddListenter=function(e){this._listener=e},e.prototype.RemoveListener=function(){this._listener=null},e.prototype.OnReceiveMessage=function(e){console.log("on receive message"),console.log(e);switch(e.cmd){case"Broadcast":var t=JSON.parse(e.data.data);null!=t&&n.GameManage.Instance().OnUpdatejump(t);break;case"UpdateData":2==this._users.length&&(e.data.userId==this._users[0].userId?n.GameManage.Instance().OnUpdateData(0,e.data.userScore):n.GameManage.Instance().OnUpdateData(1,e.data.userScore));break;case"GameResult":n.GameManage.Instance().OnGameOver(e.data);break;case"GameBegin":console.log(e.data),this._users=e.data,n.GameManage.Instance().OnGameBegin(e)}this._listener&&(console.log("call back listener "),this._listener(e.data))},e}();i.MessageProxy=o},{"./manage/GameManage":15}],12:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("../manage/EventManage"),n=e("../Enum/EventEnum"),o=e("../manage/ResourceManage"),s=function(){function e(){this.AddListener()}return e.prototype.AddListener=function(){a.EventManage.Instance().AddListener(n.EventEnum.start_game,this.StartGame.bind(this))},e.prototype.StartGame=function(){0==e.isPreLoad?(o.ResourceManage.Instance().ResourceVersion(),e.isPreLoad=!0):a.EventManage.Instance().Broadcast(n.EventEnum.preLoad_complete)},e.isPreLoad=!1,e}();i.PreLoadController=s},{"../Enum/EventEnum":1,"../manage/EventManage":14,"../manage/ResourceManage":16}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("../GameSystem/GameController"),n=e("../PreLoadSystem/PreLoadController"),o=e("../GameOverSystem/GameOverController"),s=function(){function e(){}return e.Instance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.Init=function(){this.mPreLoadController=new n.PreLoadController,this.mGameController=new a.GameController,this.mGameOverController=new o.GameOverController},e.prototype.Reset=function(){e.instance=null},e}();i.ControllerManage=s},{"../GameOverSystem/GameOverController":3,"../GameSystem/GameController":5,"../PreLoadSystem/PreLoadController":12}],14:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("../Enum/EventEnum"),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.Instance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.Init=function(){},t.prototype.Reset=function(){t.instance.offAll(),t.instance.destroy(),t.instance=null},t.prototype.Broadcast=function(e,i){void 0===i&&(i=null),t.Instance().event(a.EventEnum[e],i)},t.prototype.AddListener=function(e,i){t.Instance().on(a.EventEnum[e],this,i)},t.prototype.RemoveListener=function(e,i){t.Instance().off(a.EventEnum[e],this,i)},t}(Laya.Sprite);i.EventManage=n},{"../Enum/EventEnum":1}],15:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./EventManage"),n=e("./ControllerManage"),o=e("./ResourceManage"),s=e("../Enum/EventEnum"),r=e("../GameSystem/GameCfg"),p=e("../MessageProxy"),l=function(){function e(){this.isInitManages=!1}return e.Instance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.InitManages=function(){Laya.MouseManager.multiTouchEnabled=!1,Laya.stage.frameRate="fast",Laya.stage.scaleMode=Laya.Stage.SCALE_NOBORDER,a.EventManage.Instance().Init(),n.ControllerManage.Instance().Init(),o.ResourceManage.Instance().Init(),this.mRoot=new Laya.View,this.mRoot.width=Laya.stage.width,this.mRoot.height=Laya.stage.height,Laya.stage.addChild(this.mRoot),this.isInitManages=!0},e.prototype.Reset=function(){for(this.mRoot.destroy();this.mRootStage.length>0;)this.mRootStage.shift().destroy();this.isInitManages=!1,this.StartGame()},e.prototype.StartGame=function(){this.isInitManages||this.InitManages(),a.EventManage.Instance().Broadcast(s.EventEnum.start_game),p.MessageProxy.Instance().InitProxy()},e.prototype.ResetGame=function(){a.EventManage.Instance().Reset(),n.ControllerManage.Instance().Reset(),o.ResourceManage.Instance().Reset(),this.Reset()},e.prototype.GameOver=function(){r.default.isOver=!0,Laya.SoundManager.stopMusic(),n.ControllerManage.Instance().Reset()},e.prototype.PauseGame=function(){Laya.stage.frameRate="sleep"},e.prototype.PlayGame=function(){Laya.stage.frameRate="fast"},e.prototype.OnGameBegin=function(e){console.log("on game begin "),a.EventManage.Instance().Broadcast(s.EventEnum.net_user_info,e)},e.prototype.OnUpdateData=function(e,t){console.log("set update data"+t),a.EventManage.Instance().Broadcast(s.EventEnum.net_update_score,{id:e,score:t})},e.prototype.OnUpdatejump=function(e){console.log("set update data"+e),a.EventManage.Instance().Broadcast(s.EventEnum.net_update_jump,e)},e.prototype.OnGameOver=function(e){console.log("on game over "+e),e>0?(a.EventManage.Instance().Broadcast(s.EventEnum.over_game),this.GameOver()):(a.EventManage.Instance().Broadcast(s.EventEnum.over_game,"fail"),this.GameOver())},e}();i.GameManage=l},{"../Enum/EventEnum":1,"../GameSystem/GameCfg":4,"../MessageProxy":11,"./ControllerManage":13,"./EventManage":14,"./ResourceManage":16}],16:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e("./EventManage"),n=e("../Enum/EventEnum"),o=function(){function e(){this.Init()}return e.Instance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.Reset=function(){e.instance=null},e.prototype.Init=function(){Laya.loader.retryNum=0},e.prototype.ResourceVersion=function(){Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.PreLoad),Laya.ResourceVersion.FILENAME_VERSION)},e.prototype.PreLoad=function(){var e=[{url:"res/atlas/ui.atlas",type:Laya.Loader.ATLAS},{url:"res/atlas/player.atlas",type:Laya.Loader.ATLAS},{url:"ui/dingbubg.png",type:Laya.Loader.IMAGE},{url:"ui/genzi.png",type:Laya.Loader.IMAGE},{url:"ui/bgbig.jpg",type:Laya.Loader.IMAGE}];Laya.loader.load(e,Laya.Handler.create(this,this.PreLoadComplete),Laya.Handler.create(this,this.PreLoadProgress,null,!1))},e.prototype.PreLoadComplete=function(){console.log("preload complete"),a.EventManage.Instance().Broadcast(n.EventEnum.preLoad_complete)},e.prototype.PreLoadProgress=function(e){a.EventManage.Instance().Broadcast(n.EventEnum.preLoad_progress,e)},e.prototype.GetRes=function(e){return Laya.loader.getRes(e)},e.prototype.AsynGetRes=function(e,t){Laya.loader.load(e,t)},e}();i.ResourceManage=o},{"../Enum/EventEnum":1,"./EventManage":14}],17:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=Laya.View;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.createView(t.uiView)},t.uiView={type:"View",props:{width:750,height:1500},compId:2,child:[{type:"Image",props:{y:0,x:0,width:750,var:"bg_img",skin:"ui/bgbig2.jpg",height:1500,bottom:2},compId:6},{type:"Image",props:{y:1500,x:356,width:32,var:"img_vblock",skin:"ui/genzi.png",pivotY:1500,height:1500},compId:11},{type:"Image",props:{y:-4,x:34,skin:"ui/dingbubg2.png"},compId:7},{type:"Text",props:{y:112,x:348,width:54,var:"txt_time",valign:"middle",height:54,fontSize:40,color:"#ffffff",bold:!0,align:"center",runtime:"laya.display.Text"},compId:42},{type:"Text",props:{y:201,x:176,width:96,var:"player1_name",valign:"middle",text:"player1",height:40,fontSize:18,color:"#B69C29",bold:!0,align:"center",runtime:"laya.display.Text"},compId:44},{type:"Text",props:{y:201,x:478,width:96,var:"player2_name",valign:"middle",text:"player2",height:40,fontSize:18,color:"#B69C29",bold:!0,align:"center",runtime:"laya.display.Text"},compId:45},{type:"Box",props:{y:122,x:201,var:"hp_player1"},compId:50,child:[{type:"Image",props:{y:18,x:20,width:39,skin:"ui/hp1.png",pivotY:18,pivotX:20,name:"hp0",height:36},compId:47},{type:"Image",props:{y:18,x:62,width:39,skin:"ui/hp1.png",pivotY:18,pivotX:20,name:"hp1",height:36},compId:48},{type:"Image",props:{y:18,x:104,width:39,skin:"ui/hp1.png",pivotY:18,pivotX:20,name:"hp2",height:36},compId:49}]},{type:"Box",props:{y:122,x:424.5,var:"hp_player2"},compId:51,child:[{type:"Image",props:{y:18,x:20,width:39,skin:"ui/hp1.png",pivotY:18,pivotX:20,name:"hp0",height:36},compId:52},{type:"Image",props:{y:18,x:62,width:39,skin:"ui/hp1.png",pivotY:18,pivotX:20,name:"hp1",height:36},compId:53},{type:"Image",props:{y:18,x:104,width:39,skin:"ui/hp1.png",pivotY:18,pivotX:20,name:"hp2",height:36},compId:54}]},{type:"Image",props:{y:176,x:125,width:126,var:"player1_icon",pivotY:63,pivotX:63,height:126},compId:55,child:[{type:"Sprite",props:{width:126,renderType:"mask",height:126},compId:57,child:[{type:"Circle",props:{y:64,x:61,radius:56,lineWidth:1,fillColor:"#ff0000"},compId:58}]}]},{type:"Image",props:{y:176,x:627,width:126,var:"player2_icon",pivotY:63,pivotX:63,height:126},compId:56,child:[{type:"Sprite",props:{y:0,x:0,width:126,renderType:"mask",height:126},compId:59,child:[{type:"Circle",props:{y:63,x:62.75,radius:55,lineWidth:1,fillColor:"#ff0000"},compId:60}]}]},{type:"Image",props:{y:181,x:125,width:169,var:"p1_head_border",pivotY:87,pivotX:87,height:169},compId:62},{type:"Image",props:{y:179,x:627,width:169,var:"p2_head_border",pivotY:85,pivotX:85,height:169},compId:64}],loadList:["ui/bgbig2.jpg","ui/genzi.png","ui/dingbubg2.png","ui/hp1.png"],loadList3D:[]},t}(a);e.GameViewUI=t}(i.ui||(i.ui={}))},{}]},{},[10]);