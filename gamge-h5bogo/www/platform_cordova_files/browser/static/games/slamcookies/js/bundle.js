var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function a(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(a.prototype=o.prototype,new a)}}();!function(){function t(e,o,a){function i(r,s){if(!o[r]){if(!e[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(n)return n(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var p=o[r]={exports:{}};e[r][0].call(p.exports,function(t){return i(e[r][1][t]||t)},p,p.exports,t,e,o,a)}return o[r].exports}for(var n="function"==typeof require&&require,r=0;r<a.length;r++)i(a[r]);return i}return t}()({1:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){}return t.init=function(){Laya.ClassUtils.regClass},t.width=640,t.height=1136,t.scaleMode="fixedwidth",t.screenMode="none",t.alignV="top",t.alignH="left",t.startScene="GameMain.scene",t.sceneRoot="",t.debug=!1,t.stat=!1,t.physicsDebug=!1,t.exportSceneToJson=!0,t}();o.default=a,a.init()},{}],2:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=t("./GameConfig"),i=t("./views/RootView"),n=t("./MessageProxy"),r=function(){function t(){this.stageWidth=720,this.stageHeight=1440,Config.isAlpha=!0,Laya.init(this.stageWidth,this.stageHeight),Laya.stage.bgColor="#23b1ef",Laya.stage.scaleMode=Laya.Stage.SCALE_NOBORDER,Laya.stage.screenMode=a.default.screenMode,Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.stage.alignV=Laya.Stage.ALIGN_MIDDLE,Laya.URL.exportSceneToJson=a.default.exportSceneToJson,Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}return t.prototype.onVersionLoaded=function(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))},t.prototype.onConfigLoaded=function(){Laya.stage.screenAdaptationEnabled=!1,n.MessageProxy.Instance().InitProxy(),this.rootView=new i.RootView,Laya.stage.addChild(this.rootView)},t}();o.game=new r},{"./GameConfig":1,"./MessageProxy":3,"./views/RootView":12}],3:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=Laya.Browser,i=t("./model/PlayerData"),n=function(){function t(){}return t.Instance=function(){return null==this.s_instance&&(this.s_instance=new t),this.s_instance},t.prototype.SetGameView=function(t){this._view=t},t.prototype.InitProxy=function(){var t=this;a.window.addEventListener("message",function(e){t.OnReceiveMessage(e.data)}),this._users=[]},t.prototype.PostMessage=function(t){a.window.parent&&a.window.parent.postMessage(t,"*")},t.prototype.SendPostScore=function(t,e){this.PostMessage({cmd:"SendGameData",data:t,uid:e})},t.prototype.SendLoadReady=function(){this.PostMessage({cmd:"GameLoadReady"})},t.prototype.SendGameReady=function(){this.PostMessage({cmd:"GamePlayReady"})},t.prototype.SendGameOver=function(){this.PostMessage({cmd:"GameOver"})},t.prototype.AddListenter=function(t){this._listener=t},t.prototype.RemoveListener=function(){this._listener=null},t.prototype.OnReceiveMessage=function(t){switch(t.cmd){case"Broadcast":var e=JSON.parse(t.data.data);t.data.userId==this._users[0].userId||"addNum"==e.type&&this._view.addBlockContainerByOppo(e.dice);break;case"UpdateData":2==this._users.length&&(t.data.userId==this._users[0].userId?this._view&&this._view.UpdateScoreData(0,t.data.userScore):this._view&&this._view.UpdateScoreData(1,1));break;case"GameResult":this._view&&this._view.ShowResult(t.data);break;case"GameBegin":this._users=t.data,this._view&&(1==t.data[1].isRobot&&(i.PlayerData.Instance().setIsOppoRobote(!0),i.PlayerData.Instance().setOppositeId(t.data[1].userId),this._view.event("IS_ROBOTE_EVENT",[this._view])),this._view.SetUserData(0,t.data[0]),this._view.SetUserData(1,t.data[1]));break;case"onPause":Laya.SoundManager.musicMuted=!0,Laya.SoundManager.muted=!0;break;case"onResume":Laya.SoundManager.musicMuted=!1,Laya.SoundManager.muted=!1}this._listener&&this._listener(t.data)},t.prototype.postBlockAddToOppo=function(t){this.PostMessage({cmd:"BroadCastData",uid:i.PlayerData.Instance().getUserId(),data:{type:"addNum",dice:t,userId:i.PlayerData.Instance().getUserId()}})},t}();o.MessageProxy=n},{"./model/PlayerData":6}],4:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a,i=t("../ui/layaMaxUI"),n=t("./BlockItem"),r=t("../utils/MathTools");!function(t){t[t.Block_Cake=0]="Block_Cake",t[t.Block_Chocolate=1]="Block_Chocolate"}(a||(a={}));var s=function(t){function e(){var e=t.call(this)||this;return e.blockExplodeFlag=!1,e.blockPosArr=[],e.RandomBlockPosArr=[],e.GenerateBlockRandom=[[0,1,2],[0,1,3],[0,2,3],[1,2,3]],e.centerX=0,e.y=-120,e}return __extends(e,t),e.prototype.getBolockExplodeFlag=function(){return this.blockExplodeFlag},e.prototype.setBlockExplodeFlag=function(t){this.blockExplodeFlag=t},e.prototype.initBlockContainer=function(){this.getPieceStyle(),this.initBlockItem(),this.initContainerMove()},e.prototype.initClickBlockContainer=function(){this.blockType=a.Block_Cake,this.blockSkin="game/block_cake.png",this.initBlockItem(),this.initContainerMove()},e.prototype.getPieceStyle=function(){switch(r.MathTools.randomNum(0,3)){case 0:case 1:case 2:this.blockType=a.Block_Cake,this.blockSkin="game/block_cake.png";break;case 3:this.blockType=a.Block_Chocolate,this.blockSkin="game/block_chocolate.png"}},e.prototype.initBlockItem=function(){this.blockItem0=new n.BlockItem(this.blockType,this.blockSkin),this.block_pos0.addChild(this.blockItem0),this.blockItem1=new n.BlockItem(this.blockType,this.blockSkin),this.block_pos1.addChild(this.blockItem1),this.blockItem2=new n.BlockItem(this.blockType,this.blockSkin),this.block_pos2.addChild(this.blockItem2),this.blockItem3=new n.BlockItem(this.blockType,this.blockSkin),this.block_pos3.addChild(this.blockItem3)},e.prototype.initContainerMove=function(){Laya.timer.clearAll(this),Laya.Tween.clearAll(this)},e.prototype.resetContainerMove=function(t){Laya.timer.clearAll(this),Laya.Tween.clearAll(this)},e.prototype.addContainerY=function(t){this.y+=t},e.prototype.judgeIsBottom=function(){var t=!1;return(t=this.y>=800&&this.y<1280)&&this.event("CONTAINER_REACH_BOTTOM_EVENT",[this]),t},e.prototype.frameLoopMove=function(t){this.judgeIsBottom()},e.prototype.getBlockPosArr=function(){return this.blockPosArr},e.prototype.generateBlockItemContainer=function(){r.MathTools.randomNum(0,3);return this.RandomBlockPosArr=this.GenerateBlockRandom[r.MathTools.randomNum(0,3)],this.blockPosArr=this.RandomBlockPosArr,this.foreachBlockItems(),this},e.prototype.generateBlockItemContainerByClick=function(t){var e=[];return e.push(t),this.RandomBlockPosArr=e,this.blockPosArr=this.RandomBlockPosArr,this.foreachBlockItems(),this},e.prototype.foreachBlockItems=function(){for(var t=0;t<this.blockPosArr.length;t++)switch(this.blockPosArr[t]){case 0:this.block_pos0.visible=!0;break;case 1:this.block_pos1.visible=!0;break;case 2:this.block_pos2.visible=!0;break;case 3:this.block_pos3.visible=!0}},e.prototype.addMissBlockByIndex=function(t){return this.isNeedSplit()?(this.setBlockExplodeFlag(!0),this.playChocolateAni(),this):(this.RandomBlockPosArr.push(t),this.RandomBlockPosArr=this.RandomBlockPosArr.sort(),this.blockPosArr=this.RandomBlockPosArr,this.foreachBlockItems(),this)},e.prototype.isContainerIsMissing=function(){return this.blockPosArr.length<4},e.prototype.isBlockChocolate=function(){return this.blockType==a.Block_Chocolate},e.prototype.isNeedSplit=function(){return this.isBlockChocolate()&&!this.getBolockExplodeFlag()},e.prototype.playChocolateAni=function(){this.getBolockExplodeFlag()&&(Laya.SoundManager.playSound("sound/splite.mp3",1),this.blockItem0.doChocolateSplitEffect(),this.blockItem1.doChocolateSplitEffect(),this.blockItem2.doChocolateSplitEffect(),this.blockItem3.doChocolateSplitEffect())},e.prototype.playExplodeAni=function(){this.isBlockChocolate()?this.getBolockExplodeFlag()&&(Laya.SoundManager.playSound("sound/burst.mp3",1),this.blockItem0.doChocolateBurstEffect(),this.blockItem1.doChocolateBurstEffect(),this.blockItem2.doChocolateBurstEffect(),this.blockItem3.doChocolateBurstEffect()):(Laya.SoundManager.playSound("sound/burst.mp3",1),this.blockItem0.doCakeBurstEffect(),this.blockItem1.doCakeBurstEffect(),this.blockItem2.doCakeBurstEffect(),this.blockItem3.doCakeBurstEffect())},e.prototype.onDestory=function(){var t=this;Laya.timer.once(240,this,function(){t.doDestroy()})},e.prototype.doDestroy=function(){this.visible=!1,this.RandomBlockPosArr=[],this.blockPosArr=[],Laya.timer.clearAll(this),Laya.Tween.clearAll(this),this.removeChildren(),this.destroyChildren()},e}(i.ui.BlockContainerViewUI);o.BlockContainer=s},{"../ui/layaMaxUI":7,"../utils/MathTools":9,"./BlockItem":5}],5:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a,i=t("../ui/layaMaxUI");!function(t){t[t.Block_Cake=0]="Block_Cake",t[t.Block_Chocolate=1]="Block_Chocolate"}(a||(a={}));var n=function(t){function e(e,o){var a=t.call(this)||this;return a.blockType=e,a.blockSkin=o,a.splite_ani.interval=20,a.item_ani.interval=20,a.updateBlockSkin(),a}return __extends(e,t),e.prototype.getBlockType=function(){return this.blockType},e.prototype.setBlockType=function(t){this.blockType=t},e.prototype.getBlockSkin=function(){return this.blockSkin},e.prototype.setBlockSkin=function(t){this.blockSkin=t},e.prototype.updateBlockSkin=function(){this.item_bg.loadImage(this.getBlockSkin())},e.prototype.clearBolckItem=function(){this.visible=!1,Laya.timer.clearAll(this),Laya.Tween.clearAll(this)},e.prototype.doCakeBurstEffect=function(){this.item_ani.loadAtlas("res/atlas/bingan.atlas",Laya.Handler.create(this,this.burstEffect,["bingan",1,16]))},e.prototype.doChocolateSplitEffect=function(){this.splite_ani.loadAtlas("res/atlas/chocolate.atlas",Laya.Handler.create(this,this.splitEffect,["chocolate",1,3]))},e.prototype.doChocolateBurstEffect=function(){var t=this;Laya.timer.once(40,this,function(){t.item_bg.visible=!1}),this.item_ani.loadAtlas("res/atlas/qiaokeli.atlas",Laya.Handler.create(this,this.burstEffect,["qiaokeli",1,16]))},e.prototype.burstEffect=function(t,e,o){var a=this;this.splite_ani.visible=!1,this.item_ani.visible=!0,Laya.timer.once(50,this,function(){a.item_bg.visible=!1}),Laya.Animation.createFrames(this.aniUrls(t,e,o),"burst"),this.item_ani.play(e,!1,"burst"),this.item_ani.visible=!0,Laya.timer.once(320,this,function(){a.item_ani.visible=!1})},e.prototype.splitEffect=function(t,e,o){var a=this;this.item_ani.visible=!1,this.splite_ani.visible=!0,Laya.timer.once(50,this,function(){a.item_bg.visible=!1}),Laya.Animation.createFrames(this.aniSplitsUrls(t,e,o),"burst"),this.splite_ani.play(e,!1,"burst")},e.prototype.aniUrls=function(t,e,o){for(var a=[],i=e;i<=o;i++)i<10?a.push(t+"/1000"+i+".png"):a.push(t+"/100"+i+".png");return a},e.prototype.aniSplitsUrls=function(t,e,o){for(var a=[],i=e;i<=o;i++)i<10?a.push(t+"/ani0"+i+".png"):a.push(t+"/ani"+i+".png");return a},e}(i.ui.BlockItemUI);o.BlockItem=n},{"../ui/layaMaxUI":7}],6:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){this.bottomLine=650,this.user_name="User",this.opposite_name="User",this.user_id=0,this.opposite_id=0,this.isOppoRobote=!1,this.game_result=0,this.user_score=0,this.opposite_score=0}return t.Instance=function(){return null==this.s_instance&&(this.s_instance=new t),this.s_instance},t.prototype.setBottomLine=function(t){this.bottomLine=t},t.prototype.getBottomLine=function(){return this.bottomLine},t.prototype.setIsOppoRobote=function(t){this.isOppoRobote=t},t.prototype.getIsOppoRobote=function(){return this.isOppoRobote},t.prototype.setUserScore=function(t){this.user_score=t},t.prototype.addUserScore=function(t){this.user_score+=t},t.prototype.getOppositeScore=function(){return this.opposite_score},t.prototype.setOppositeScore=function(t){this.opposite_score=t},t.prototype.setUserId=function(t){this.user_id=t},t.prototype.getUserId=function(){return this.user_id},t.prototype.setOppositeId=function(t){this.opposite_id=t},t.prototype.getOppositeId=function(){return this.opposite_id},t.prototype.setGameResult=function(t){this.game_result=t},t.prototype.getGameResult=function(){return this.game_result},t.prototype.getUserName=function(){return this.user_name},t.prototype.setUserName=function(t){this.user_name=t},t.prototype.getOppositeName=function(){return this.opposite_name},t.prototype.setOppositeName=function(t){this.opposite_name=t},t}();o.PlayerData=a},{}],7:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=Laya.View;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:660},compId:2,child:[{type:"Sprite",props:{y:0,visible:!1,var:"block_pos0"},compId:3},{type:"Sprite",props:{y:0,x:164,visible:!1,var:"block_pos1"},compId:4},{type:"Sprite",props:{y:0,x:328,visible:!1,var:"block_pos2"},compId:5},{type:"Sprite",props:{y:0,x:492,visible:!1,var:"block_pos3"},compId:6}],loadList:[],loadList3D:[]},e}(a);t.BlockContainerViewUI=e;var o=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:1,height:1},compId:2,child:[{type:"Sprite",props:{x:0,width:165,var:"item_bg",texture:"game/block_cake.png",pivotX:.9,height:110},compId:3},{type:"Animation",props:{y:-103,x:-96,var:"item_ani"},compId:4},{type:"Animation",props:{x:-5,var:"splite_ani",pivotX:.9},compId:11}],loadList:["game/block_cake.png"],loadList3D:[]},e}(a);t.BlockItemUI=o;var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:1440},compId:2,child:[{type:"Box",props:{y:650,x:359,width:1,var:"box_container",pivotY:450,pivotX:360,height:1},compId:3}],loadList:[],loadList3D:[]},e}(a);t.GameEndViewUI=i;var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,visible:!0,height:1440},compId:2,child:[{type:"Sprite",props:{y:0,x:0,visible:!0,var:"game_topbg",texture:"game/game_topbg.png",scaleY:1.35},compId:6},{type:"Sprite",props:{y:360,x:0,var:"game_bodybg",texture:"game/game_bodybg.png",height:1080},compId:25,child:[{type:"Sprite",props:{y:850,x:33.5,width:653,var:"bottom_line",texture:"game/bottom_line.png",height:20},compId:5},{type:"Sprite",props:{y:0,x:517,width:164,visible:!0,var:"road3",height:930},compId:22},{type:"Sprite",props:{y:0,x:30,width:164,visible:!0,var:"road0",height:930},compId:17},{type:"Sprite",props:{y:0,x:194,width:164,visible:!0,var:"road1",height:930},compId:18},{type:"Sprite",props:{y:0,x:358,width:164,visible:!0,var:"road2",height:930},compId:21},{type:"Sprite",props:{y:-100,x:0,width:720,visible:!0,var:"container_move",height:1446},compId:46}]},{type:"Box",props:{y:243,width:350,visible:!0,var:"competitor_box",right:0,height:100},compId:11,child:[{type:"Sprite",props:{y:36,x:-10,var:"oppo_name",texture:"game/score_bg2.png"},compId:12,child:[{type:"Label",props:{y:32,x:120,width:155,var:"oppoName",valign:"middle",text:"oppoName",pivotY:15,pivotX:78,height:30,fontSize:25,color:"#fff",bold:!0,align:"left"},compId:35}]},{type:"Sprite",props:{y:10,x:170,texture:"game/head_ring.png",scaleY:.95,scaleX:.95},compId:13,child:[{type:"Sprite",props:{texture:"game/head_bg.png"},compId:41},{type:"Sprite",props:{y:-21,x:-22,visible:!0,var:"oppohead_add",scaleY:.45,scaleX:.45},compId:44}]},{type:"Sprite",props:{y:12,x:173,width:85,var:"oppohead",scaleY:.95,scaleX:.95,height:85},compId:14,child:[{type:"Sprite",props:{y:10,x:10,width:78,renderType:"mask",height:78},compId:36,child:[{type:"Circle",props:{y:33,x:33,radius:40,lineWidth:1,fillColor:"#ff0c08"},compId:37}]}]}]},{type:"Box",props:{y:243,width:350,var:"user_box",left:0,height:100},compId:8,child:[{type:"Sprite",props:{y:36,x:140,var:"user_name",texture:"game/score_bg1.png"},compId:7,child:[{type:"Label",props:{y:32,x:130,width:153,var:"username",text:"userName",pivotY:13,pivotX:77,height:25,fontSize:25,color:"#fff",bold:!0,align:"left"},compId:34}]},{type:"Sprite",props:{y:10,x:91,texture:"game/head_ring.png",scaleY:.95,scaleX:.95},compId:10,child:[{type:"Sprite",props:{texture:"game/head_bg.png"},compId:40},{type:"Sprite",props:{y:-21,x:-21,visible:!0,var:"userhead_add",scaleY:.45,scaleX:.45},compId:45}]},{type:"Sprite",props:{y:10,x:95,width:85,var:"userhead",scaleY:.95,scaleX:.95,height:85},compId:9,child:[{type:"Sprite",props:{y:15,x:12,width:78,renderType:"mask",height:78},compId:38,child:[{type:"Circle",props:{y:30,x:30,radius:40,lineWidth:1,fillColor:"#fb0a06"},compId:39}]}]}]},{type:"Sprite",props:{y:600,x:190},compId:28,child:[{type:"Sprite",props:{y:62,x:180,width:364,visible:!1,var:"ready",texture:"game/game_ready.png",scaleY:0,scaleX:0,pivotY:62,pivotX:180,height:123},compId:29},{type:"Sprite",props:{y:63,x:184,width:154,visible:!0,var:"go",texture:"game/game_go.png",scaleY:0,scaleX:0,pivotY:54,pivotX:78,height:106},compId:30}]}],loadList:["game/game_topbg.png","game/game_bodybg.png","game/bottom_line.png","game/score_bg2.png","game/head_ring.png","game/head_bg.png","game/score_bg1.png","game/game_ready.png","game/game_go.png"],loadList3D:[]},e}(a);t.GameMainUI=n;var r=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:720},compId:2,child:[{type:"Sprite",props:{y:352,x:352},compId:3,child:[{type:"Sprite",props:{y:53.5,x:10.5,width:642,var:"win_bg",texture:"game/win_bg.png",pivotY:325,pivotX:320,height:642},compId:4},{type:"Sprite",props:{y:-346,x:-336,width:678,texture:"game/win.png",height:679},compId:5}]}],loadList:["game/win_bg.png","game/win.png"],loadList3D:[]},e}(a);t.GameWinViewUI=r;var s=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:720},compId:2,child:[{type:"Sprite",props:{y:240,x:85,texture:"game/lose.png"},compId:3}],loadList:["game/lose.png"],loadList3D:[]},e}(a);t.LossViewUI=s;var l=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:1280,autoDestroyAtClosed:!0},compId:2,child:[{type:"Box",props:{y:0,x:0,var:"layer_maingame"},compId:3},{type:"Box",props:{y:0,x:0,var:"layer_over"},compId:4}],loadList:[],loadList3D:[]},e}(a);t.RootViewUI=l}(o.ui||(o.ui={}))},{}],8:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){this.nowNum=1,this.upGoEffectnum=0,this.upGoEffectFunc=null,this.objAddEffectFunc=null,this.objAddToEffectFunc=null,this.objGuiderEffectFunc=null}return t.prototype.play=function(t,e,o,a,i,n){void 0===i&&(i=!1),null!=t&&null!=e&&null!=o&&null!=i&&(this.num=o,null!=n&&(this.func=n),t.skin=e+this.nowNum.toString()+"."+a,Laya.timer.frameLoop(2,this,this.imgloop,[t,e,a,i]))},t.prototype.imgloop=function(t,e,o,a){this.nowNum<this.num?(this.nowNum+=1,t.skin=e+this.nowNum.toString()+"."+o):!0===a?this.nowNum=0:(null!=this.func&&this.func(),Laya.timer.clear(this,this.imgloop))},t.prototype.upGoEffect=function(t,e,o,a,i){if(null!=t&&null!=e&&null!=o&&null!=a){this.upGoEffectnum=Math.floor(1e3*o/50),t.alpha=1;Laya.Tween.to(t,{scale:4},1e3*o,Laya.Ease.strongOut,null,0),null!=i&&(this.upGoEffectFunc=i),Laya.timer.loop(50,this,this.objUpLoop,[t,e,o,a])}},t.prototype.objUpLoop=function(t,e,o,a){this.upGoEffectnum-=1,a&&(t.alpha=this.upGoEffectnum/Math.floor(1e3*o/80)),this.upGoEffectnum>=0?t.y-=e:(null!=this.upGoEffectFunc&&this.upGoEffectFunc(),Laya.timer.clear(this,this.objUpLoop))},t.prototype.objAddEffect=function(t,e,o,a,i){null!=i&&(this.objAddEffectFunc=i),Laya.Tween.to(t,{scaleX:1.2,scaleY:1.2},o/2,Laya.Ease.strongOut,null,0),Laya.Tween.to(t,{scaleX:1,scaleY:1},o/2,Laya.Ease.strongOut,null,o/2),Laya.Tween.to(t,{y:e},o,Laya.Ease.strongOut,Laya.Handler.create(this,this.afterAddEffect,[]),0)},t.prototype.afterAddEffect=function(){null!=this.objAddEffectFunc&&this.objAddEffectFunc(),Laya.timer.clear(this,this.objAddEffect)},t.prototype.objAddToEffect=function(t,e,o,a,i){null!=i&&(this.objAddToEffectFunc=i),a&&(Laya.Tween.to(t,{alpha:1},o/2,Laya.Ease.strongOut,null,0),Laya.Tween.to(t,{alpha:0},o/2,Laya.Ease.strongOut,null,o/2)),Laya.Tween.to(t,{},o,Laya.Ease.strongOut,Laya.Handler.create(this,this.afterAddToEffect),0)},t.prototype.afterAddToEffect=function(){null!=this.objAddToEffectFunc&&this.objAddToEffectFunc(),Laya.timer.clear(this,this.objAddToEffect)},t.prototype.objGuiderClickEffect=function(t,e,o,a,i,n){null!=n&&(this.objGuiderEffectFunc=n),i&&(t.alpha=.6),Laya.Tween.to(t,{alpha:1,scaleX:.8,scaleY:.8},a/4,Laya.Ease.strongOut,null,0),Laya.Tween.to(e,{scaleX:.5,scaleY:.3},a/4,Laya.Ease.strongOut,null,0),Laya.Tween.to(t,{alpha:.6,scaleX:1,scaleY:1},a/4,Laya.Ease.strongOut,null,a/4),Laya.Tween.to(e,{scaleX:1,scaleY:.6},a/4,Laya.Ease.strongOut,null,a/4),Laya.Tween.to(t,{alpha:1,scaleX:.8,scaleY:.8},a/4,Laya.Ease.strongOut,null,a/2),Laya.Tween.to(e,{scaleX:.5,scaleY:.3},a/4,Laya.Ease.strongOut,null,a/2),Laya.Tween.to(t,{alpha:.6,scaleX:1,scaleY:1},a/4,Laya.Ease.strongOut,null,3*a/4),Laya.Tween.to(e,{scaleX:1,scaleY:.6},a/4,Laya.Ease.strongOut,null,3*a/4),Laya.Tween.to(t,{},a,Laya.Ease.strongOut,Laya.Handler.create(this,this.afterGuiderClickEffect),0)},t.prototype.afterGuiderClickEffect=function(){null!=this.objGuiderEffectFunc&&this.objGuiderEffectFunc(),Laya.timer.clear(this,this.objGuiderClickEffect)},t.prototype.objGuiderMoveEffect=function(t,e,o,a,i,n,r){null!=r&&(this.objGuiderEffectFunc=r),n&&(t.alpha=.6,t.scaleX=1,t.scaleY=1,e.alpha=.6),Laya.Tween.to(t,{alpha:1,scaleX:.8,scaleY:.8},400,Laya.Ease.strongOut,null,0),Laya.Tween.to(t,{alpha:.6,scaleX:1,scaleY:1},400,Laya.Ease.strongOut,null,i-400),Laya.Tween.to(e,{alpha:1,y:a},i/4,Laya.Ease.strongOut,null,0),Laya.Tween.to(e,{alpha:.6,y:o},i/4,Laya.Ease.strongOut,null,i/4),Laya.Tween.to(e,{alpha:1,y:a},i/4,Laya.Ease.strongOut,null,i/2),Laya.Tween.to(e,{alpha:.6,y:o},i/4,Laya.Ease.strongOut,null,3*i/4),Laya.Tween.to(t,{y:a},i,Laya.Ease.strongOut,Laya.Handler.create(this,this.afterGuiderMoveEffect),0)},t.prototype.afterGuiderMoveEffect=function(){null!=this.objGuiderEffectFunc&&this.objGuiderEffectFunc(),Laya.timer.clear(this,this.objGuiderMoveEffect)},t.prototype.burstEffect=function(t,e,o){Laya.timer.loop(30,this,this.doBurstEffecttFun,[t,e])},t.prototype.doBurstEffecttFun=function(t,e){t.load(e,!0)},t.prototype.effectClear=function(t,e,o){null!==t&&null!==e&&(this.effectClearNum=Math.floor(1e3*e/30),null!=o&&(this.effectClearFunc=o),t.scaleX=0,Laya.timer.loop(30,this,this.effectClearLoop,[t,e]))},t.prototype.effectClearLoop=function(t,e){if(this.effectClearNum>=0&&t.scaleX<=.7)this.effectClearNum-=1,t.scaleX=1-this.effectClearNum/Math.floor(1e3*e/30);else if(this.effectClearNum>=0&&t.scaleX<=.9)t.scaleX=.95;else if(this.effectClearNum>=0&&t.scaleX>=.9){t.scaleX=1;var o=new Laya.Image;o.skin="game/img_bt21_tx.png",o.pivot(318,33),o.scale(1.1,1.1),t.addChild(o),o.x=t.width/2,o.y=t.height/2,this.effectClearNum=-1}else this.effectClearNum<=0&&(t.destroyChildren(),null!=this.effectClearFunc&&this.effectClearFunc(),Laya.timer.clear(this,this.effectClearLoop))},t.prototype.stop=function(t){Laya.timer.clear(this,t)},t}();o.AniUtils=a},{}],9:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){}return t.getAngleFormY=function(t,e,o,a){var i=Math.abs(t-o),n=Math.abs(e-a),r=n/Math.sqrt(Math.pow(i,2)+Math.pow(n,2)),s=Math.acos(r),l=180/(Math.PI/s);return o>t&&a>e?l=l:o==t&&a>e?l=180:o>t&&a==e?l=90:o<t&&a>e?l=-l:o<t&&a==e?l=-90:o<t&&a<e?l=-180+l:o>t&&a<e&&(l=180-l),l},t.getDistance=function(t,e,o,a){var i=Math.abs(t-o),n=Math.abs(e-a);return Math.sqrt(Math.pow(i,2)+Math.pow(n,2))},t.randomNum=function(t,e){return t+Math.round((e-t)*Math.random())},t.randomFloat=function(t,e){return t+(e-t)*Math.random()},t.pieceMoveFromTween=function(t,e,o){Laya.Tween.from(t,{x:e,y:o},1e3,Laya.Ease.elasticOut,null,0)},t.pieceMoveToTween=function(t,e,o){Laya.Tween.to(t,{x:e,y:o},1e3,Laya.Ease.elasticOut,null,0)},t.isArrayEquals=function(t,e){if(t.length!=e.length)return!1;for(var o=0,a=this.length;o<a;o++)if(t instanceof Array&&e instanceof Array){if(t[o]!=e[o])return!1}else if(t[o]!=e[o])return!1;return!0},t.getMissBlockPosArr=function(t){for(var e=[],o=0;o<4;o++)-1==t.indexOf(o)&&e.push(o);return e},t.isElementInArray=function(t,e){return-1!=t.indexOf(e)},t.nameStringPro=function(t,e){var o=/[\u4e00-\u9fa5]/g,a=t.substring(0,e),i=~~(a.match(o)&&a.match(o).length),n=2*a.length-i;return t.substr(0,n)+(n<t.length?"...":"")},t}();o.MathTools=a},{}],10:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a,i=t("../ui/layaMaxUI"),n=t("../Main"),r=t("../model/PlayerData"),s=t("../MessageProxy");!function(t){t[t.Layer_Main=0]="Layer_Main",t[t.Layer_Over=1]="Layer_Over"}(a||(a={}));var l=function(t){function e(){var e=t.call(this)||this;return e.timerNum=4,e}return __extends(e,t),e.prototype.init=function(){r.PlayerData.Instance().getGameResult()>=0?this.showUserWin():this.showUserLose()},e.prototype.showUserWin=function(){var t=this,e=new i.ui.GameWinViewUI;this.box_container.addChild(e),Laya.SoundManager.playSound("sound/win.mp3",1),Laya.Tween.to(this.box_container,{scaleX:1,scaleY:1},500,Laya.Ease.strongOut,null,0),Laya.timer.frameLoop(5,this,function(){t.rotationLight(e.win_bg)})},e.prototype.showUserLose=function(){var t=new i.ui.LossViewUI;this.box_container.addChild(t),Laya.SoundManager.playSound("sound/over.mp3",1),Laya.Tween.to(this.box_container,{scaleX:1,scaleY:1},500,Laya.Ease.strongOut,null,0)},e.prototype.rotationLight=function(t){t.rotation+=2},e.prototype.onDestory=function(){s.MessageProxy.Instance().SetGameView(null),s.MessageProxy.Instance().SendGameOver(),Laya.SoundManager.stopAll(),Laya.timer.clearAll(this),this.removeSelf(),this.destroy()},e.prototype.timerCutDownView=function(){this.timerNum-=1,this.timerNum<=0&&(this.onDestory(),n.game.rootView.closeView(n.game.rootView.gameMainUI,a.Layer_Main),n.game.rootView.closeView(n.game.rootView.gameEndView,a.Layer_Over))},e}(i.ui.GameEndViewUI);o.GameEndView=l},{"../Main":2,"../MessageProxy":3,"../model/PlayerData":6,"../ui/layaMaxUI":7}],11:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a,i=t("../ui/layaMaxUI"),n=t("../model/BlockItem"),r=t("../model/BlockContainer"),s=t("../utils/MathTools"),l=t("../MessageProxy"),c=t("../model/PlayerData"),p=t("../Main"),h=t("../utils/AniUtils");!function(t){t[t.Block_Cake=0]="Block_Cake",t[t.Block_Chocolate=1]="Block_Chocolate"}(a||(a={}));var u;!function(t){t[t.Layer_Main=0]="Layer_Main",t[t.Layer_Over=1]="Layer_Over"}(u||(u={}));var d=function(t){function e(){var e=t.call(this)||this;return e.creatFrame=40,e.moveFrame=1,e.isReady=!1,e.isGameOver=!1,e.isNeedPutRoad=!1,e.curOppRoadPos=0,e.roadArr=[e.road0,e.road1,e.road2,e.road3],e.containerArr=[],e.operateArr=[],e.notMissBlockNum=0,e.creatBlockNum=0,e.blockArr=[],e.curRoadNumArr=[],e.tipsAddList=[],e.tipsAddToList=[],e.isGuiderClick=0,e.isGuiderMove=!1,e.roboteAiNum=0,e.canTouch=!0,e.isWarning=!1,Laya.MouseManager.multiTouchEnabled=!1,e.setChildIndex(e.game_topbg,1),l.MessageProxy.Instance().SendLoadReady(),l.MessageProxy.Instance().SendGameReady(),l.MessageProxy.Instance().SetGameView(e),e.initTouchEvent(),e.showReady(),Laya.timer.frameLoop(e.creatFrame,e,e.creatBlockContainer,[]),Laya.timer.frameLoop(e.moveFrame,e,e.frameLoopContainerMoveDown,[1.5]),Laya.timer.loop(2e3,e,e.tipsHelper),e.on("IS_ROBOTE_EVENT",e,e.roboteAI),e}return __extends(e,t),e.Instance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.frameLoopLineMoveDown=function(t){var e=c.PlayerData.Instance().getBottomLine();e-=t,c.PlayerData.Instance().setBottomLine(e)},e.prototype.frameLoopContainerMoveDown=function(t){this.judgeIsBottom()||(this.container_move.y+=t),this.frameLoopLineMoveDown(t)},e.prototype.judgeIsBottom=function(){if(!(this.containerArr.length<=0)){var t=c.PlayerData.Instance().getBottomLine(),e=!1;if(t-this.containerArr[0].y<-250)e=!0;else{if(t-this.containerArr[0].y<0&&!this.isWarning){this.isWarning=!0;var o=new Laya.Image;o.skin="game/langgan2.png",o.x=33.5,o.y=1179,o.alpha=0,this.addChild(o),this.playMusicWarn();new h.AniUtils;Laya.Tween.to(o,{alpha:1},500,Laya.Ease.strongOut,null,0),Laya.Tween.to(o,{alpha:0},500,Laya.Ease.strongOut,Laya.Handler.create(this,this.playMusicWarn),500),Laya.Tween.to(o,{alpha:1},500,Laya.Ease.strongOut,null,1e3),Laya.Tween.to(o,{alpha:0},500,Laya.Ease.strongOut,Laya.Handler.create(this,this.playMusicWarn),1500),Laya.Tween.to(o,{alpha:1},500,Laya.Ease.strongOut,null,2e3),Laya.Tween.to(o,{alpha:0},500,Laya.Ease.strongOut,Laya.Handler.create(this,this.afterShowWarning),2500);var a=new Laya.Image;a.skin="game/danger.png",a.x=286,a.y=1149,a.alpha=0,this.addChild(a),Laya.Tween.to(a,{alpha:1},500,Laya.Ease.strongOut,null,0),Laya.Tween.to(a,{alpha:0},500,Laya.Ease.strongOut,null,500),Laya.Tween.to(a,{alpha:1},500,Laya.Ease.strongOut,null,1e3),Laya.Tween.to(a,{alpha:0},500,Laya.Ease.strongOut,null,1500),Laya.Tween.to(a,{alpha:1},500,Laya.Ease.strongOut,null,2e3),Laya.Tween.to(a,{alpha:0},500,Laya.Ease.strongOut,null,2500)}e=!1}return e&&this.postGameOver(),e}},e.prototype.afterShowWarning=function(){this.isWarning=!1},e.prototype.roboteAI=function(){var t=this;Laya.timer.clear(this,this.roboteAI),Laya.timer.loop(2e3,this,function(){var e=s.MathTools.randomNum(0,3);t.roboteAiNum+=e,t.roboteAiNum<30?t.addBlockContainerByOppo(e):(Laya.timer.clearAll(t),l.MessageProxy.Instance().SendPostScore(0,c.PlayerData.Instance().getOppositeId()),c.PlayerData.Instance().setGameResult(1))})},e.prototype.showReady=function(){this.go.visible=!0,this.ready.visible=!0,Laya.Tween.to(this.ready,{scaleX:1,scaleY:1},400,Laya.Ease.strongOut,null,0),Laya.Tween.to(this.ready,{scaleX:0,scaleY:0},300,Laya.Ease.strongOut,null,400),Laya.Tween.to(this.go,{scaleX:1,scaleY:1},400,Laya.Ease.strongOut,null,700),Laya.Tween.to(this.go,{scaleX:0,scaleY:0},300,Laya.Ease.strongOut,Laya.Handler.create(this,this.resetReadyGo),1100),Laya.SoundManager.playSound("sound/readygo.mp3",1,new Laya.Handler(this,this.playMusicBg))},e.prototype.resetReadyGo=function(){this.go.scale(.1,.1),this.go.visible=!1,this.ready.scale(.1,.1),this.ready.visible=!1,this.isReady=!0},e.prototype.playMusicWarn=function(){Laya.SoundManager.playSound("sound/warn.mp3",1)},e.prototype.playMusicBg=function(){Laya.SoundManager.stopSound("sound/readygo.mp3"),Laya.SoundManager.playMusic("sound/bg.mp3",0)},e.prototype.stopPlayMusicBg=function(){Laya.SoundManager.stopMusic()},e.prototype.initTouchEvent=function(){this.road0.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown,[Laya.Event,0]),this.road1.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown,[Laya.Event,1]),this.road2.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown,[Laya.Event,2]),this.road3.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown,[Laya.Event,3])},e.prototype.onMouseDown=function(t,e){this.isReady&&!this.isGameOver&&(this.touchEventStartY=Laya.stage.mouseY,Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onMouseUp,[t,e]),Laya.stage.on(Laya.Event.MOUSE_OUT,this,this.onMouseUp,[t,e]))},e.prototype.onMouseUp=function(t,e){if(Laya.SoundManager.playSound("sound/click.mp3",1),!(this.containerArr.length<=0)){this.curOppRoadPos=e,this.touchEventEndY=Laya.stage.mouseY,Laya.stage.off(Laya.Event.MOUSE_UP,this,this.onMouseUp),Laya.stage.off(Laya.Event.MOUSE_OUT,this,this.onMouseUp);var o=Math.abs(this.touchEventStartY-this.touchEventEndY);this.operateArr=this.calculateCurrentPopContainArr(this.containerArr),this.isNeedPutRoad=this.calculateMovePosition(this.operateArr,this.curOppRoadPos),o>=100?this.createBlockArr(this.creatBlockNum,this.curOppRoadPos,!1):this.createBlockArr(1,this.curOppRoadPos,!0)}},e.prototype.tipsHelper=function(){var t=this.calculateCurrentPopContainArr(this.containerArr);0!=t.length&&(t.length>1&&!this.isGuiderMove?this.guider2Click(s.MathTools.getMissBlockPosArr(t[0].getBlockPosArr())[0]):this.isGuiderClick<2&&3==t[0].getBlockPosArr().length&&this.guider1Click(s.MathTools.getMissBlockPosArr(t[0].getBlockPosArr())[0]))},e.prototype.creatBlockContainer=function(){this.isReady=!0;this.containerArr.length;if(!this.isGameOver){var t=Laya.Pool.getItemByClass("container",r.BlockContainer);t.initBlockContainer(),t.generateBlockItemContainer(),this.containerArr.length>0&&(t.y=this.containerArr[this.containerArr.length-1].y-110),this.container_move.addChild(t),this.containerArr.push(t),console.log("creatBlockContainer: "+this.containerArr.length)}},e.prototype.creatBlockContainerByClick=function(t){if(!this.isGameOver){var e=Laya.Pool.getItemByClass("container",r.BlockContainer);e.initClickBlockContainer(),e.generateBlockItemContainerByClick(t),e.centerX=0,e.y=this.containerArr[0].y+110,this.container_move.addChild(e),this.containerArr.unshift(e)}},e.prototype.createBlockArr=function(t,e,o){if(this.canTouch){this.canTouch=!1;var i=this.containerArr[0].y;this.isNeedPutRoad||(t=1,i+=110);for(var r=0;r<t;r++){var s=new n.BlockItem(a.Block_Cake,"game/block_cake.png");s.y=this.bottom_line.y+120*r,this.roadArr[e].addChild(s),this.blockArr.push(s),s.tween=Laya.Tween.to(s,{y:Math.abs(i%1440-1440)+120*r},100,Laya.Ease.strongOut,Laya.Handler.create(this,this.doAfterBlockArrsMoved,[o]),0)}return this.blockArr}},e.prototype.calculateCurrentPopContainArr=function(t){var e=[],o=!1;if(0==t.length)return e;var a=t[0].getBlockPosArr();this.curRoadNumArr=s.MathTools.getMissBlockPosArr(a);for(var i=[],n=0;n<t.length;n++)if(3==t[n].getBlockPosArr().length){i=t[n].getBlockPosArr();break}for(n=0;n<t.length;n++)if(4==t[n].getBlockPosArr().length)o=!0,e.push(t[n]);else if(t[n].getBlockPosArr().length<3)e.push(t[n]);else{if(a.toString()!=t[n].getBlockPosArr().toString()&&i.toString()!=t[n].getBlockPosArr().toString())break;if(o)break;e.push(t[n])}return e},e.prototype.calculateMovePosition=function(t,e){var o=t.length;t[0];this.notMissBlockNum=0,this.creatBlockNum=0;for(var a=!1,i=o-1;i>=0&&!t[i].isContainerIsMissing();i--)this.notMissBlockNum+=1;for(i=0;i<t.length;i++){var n=t[i].getBlockPosArr();if(!this.isInNeedAddRoadArr(n,e))return!!a||(this.creatBlockNum=1,!1);t[i],a=!0,this.creatBlockNum+=1}return!0},e.prototype.doAfterBlockArrsMoved=function(t){var e=this.blockArr.length,o=e+this.notMissBlockNum,a=this.operateArr.length;if(this.canTouch=!0,this.isNeedPutRoad){if(t){for(n=a-this.notMissBlockNum-1;n>=0;n--)if(this.isInNeedAddRoadArr(this.operateArr[n].getBlockPosArr(),this.curOppRoadPos)){this.operateArr[n].addMissBlockByIndex(this.curOppRoadPos);break}}else for(n=e-1;n>=0;n--)this.operateArr[n].addMissBlockByIndex(this.curOppRoadPos);if(a>o){for(n=0;n<e;n++)this.blockArr[n].clearBolckItem();this.blockArr=[]}else if(a==o){for(var i=0,n=0;n<a;n++){if(4!=this.operateArr[n].getBlockPosArr().length){this.operateArr=[];break}i+=1,this.operateArr[n].playExplodeAni(),this.operateArr[n].onDestory()}this.containerArr.splice(0,i);for(n=0;n<e;n++)this.blockArr[n].clearBolckItem();this.addBlockContainerToOppo(i),this.blockArr=[]}else this.blockArr=[]}else{for(n=0;n<e;n++)this.blockArr[n].clearBolckItem();this.blockArr=[],this.creatBlockContainerByClick(this.curOppRoadPos)}},e.prototype.isInNeedAddRoadArr=function(t,e){return!s.MathTools.isElementInArray(t,e)},e.prototype.addBlockContainerByOppo=function(t){var e=this;console.log("addBlockContainerByOppo :"+t);var o=this.containerArr.length;if(!(o<=0||t<=0)){Laya.timer.clear(this,this.frameLoopContainerMoveDown),Laya.timer.frameLoop(this.moveFrame,this,this.frameLoopContainerMoveDown,[15]),this.effectTipsAddContainer(t);for(var a=this.containerArr[o-1].y,i=0;i<t;i++){var n=Laya.Pool.getItemByClass("container",r.BlockContainer);n.initBlockContainer(),n.generateBlockItemContainer(),n.y=a-110*(1+i),this.container_move.addChild(n),this.containerArr.push(n)}Laya.timer.frameOnce(this.creatFrame/8*t,this,function(){Laya.timer.frameLoop(e.moveFrame,e,e.frameLoopContainerMoveDown,[1.5])})}},e.prototype.addBlockContainerToOppo=function(t){t>0&&(t>5&&(t=5),this.effectTipsAddToContainer(t),l.MessageProxy.Instance().postBlockAddToOppo(t))},e.prototype.guider1Click=function(t){var e=this,o=this.road0;o=0==t?this.road0:1==t?this.road1:2==t?this.road2:this.road3;var a=new h.AniUtils,i=new Laya.Image;i.skin="game/guide_click.png",i.x=o.x+30,i.y=this.bottom_line.y+200,i.scale(1,1);var n=new Laya.Image;n.skin="game/shade.png",n.x=o.x+30,n.y=this.bottom_line.y+260,n.scale(1,.8),this.addChild(n),this.addChild(i),a.objGuiderClickEffect(i,n,0,1600,!0,function(){i.visible=!1,n.visible=!1,e.isGuiderClick+=1})},e.prototype.guider2Click=function(t){var e=this,o=this.road0;o=0==t?this.road0:1==t?this.road1:2==t?this.road2:this.road3;var a=new h.AniUtils,i=new Laya.Image;i.skin="game/guide_move.png",i.x=o.x,i.y=this.bottom_line.y;var n=new Laya.Image;n.skin="game/guide_click.png",n.x=o.x+50,n.y=this.bottom_line.y+150,this.addChild(i),this.addChild(n),a.objGuiderMoveEffect(n,i,this.bottom_line.y+20,this.bottom_line.y,1e3,!0,function(){n.visible=!1,i.visible=!1,e.isGuiderMove=!0})},e.prototype.effectTipsAddContainer=function(t){var e=new h.AniUtils,o=this.pool(this.tipsAddList,new Laya.Label);p.game.rootView.gameMainUI.addChild(this.tipsAddList[o]),this.tipsAddList[o].destroyChildren(),this.tipsAddList[o].y=420,this.tipsAddList[o].x=60,this.tipsAddList[o].scale(1,1);var a=new Laya.Image;a.skin="score/num_add.png";var i=new Laya.Image;i.x=a.x+50,i.skin="score/num_add"+t+".png",this.tipsAddList[o].addChild(a),this.tipsAddList[o].addChild(i),this.tipsAddList[o].anchorX=i.x,this.tipsAddList[o].anchorY=i.y+i.height/2,e.objAddEffect(this.tipsAddList[o],380,800,!1,function(){p.game.rootView.gameMainUI.tipsAddList[o].visible=!1})},e.prototype.effectTipsAddToContainer=function(t){var e=new h.AniUtils,o=this.pool(this.tipsAddToList,new Laya.Label);p.game.rootView.gameMainUI.addChild(this.tipsAddToList[o]),this.tipsAddToList[o].destroyChildren(),this.tipsAddToList[o].y=450,this.tipsAddToList[o].x=100,this.tipsAddToList[o].scale(1,1);var a=new Laya.Image;a.skin="game/hint0"+t+".png",this.tipsAddToList[o].addChild(a),e.objAddToEffect(this.tipsAddToList[o],0,600,!0,function(){p.game.rootView.gameMainUI.tipsAddToList[o].visible=!1})},e.prototype.pool=function(t,e){var o,a=!1;if(t.length>0){for(var i=0;i<t.length;i++)if(null===t[i].text){a=!0,o=i;break}if(!a){n=e;t.push(n),o=t.length-1}}else{var n=e;t.push(n),o=t.length-1}return o},e.prototype.openGameEndView=function(){p.game.rootView.openView(p.game.rootView.gameEndView,u.Layer_Over)},e.prototype.SetUserData=function(t,e){0==t?(c.PlayerData.Instance().setUserId(t),this.username.text=s.MathTools.nameStringPro(e.userName,5),this.drowCircleImg(this.userhead,e.userHead),this.drowCircleImg(this.userhead_add,e.userHeadFrame)):(c.PlayerData.Instance().setUserId(t),this.oppoName.text=s.MathTools.nameStringPro(e.userName,5),this.drowCircleImg(this.oppohead,e.userHead),this.drowCircleImg(this.oppohead_add,e.userHeadFrame))},e.prototype.drowCircleImg=function(t,e){0!=e.length&&t.loadImage(e)},e.prototype.ShowResult=function(t){console.log("ShowResult :"+t),c.PlayerData.Instance().getIsOppoRobote()||c.PlayerData.Instance().setGameResult(t),this.isGameOver||(this.isGameOver=!0),Laya.timer.clearAll(this),Laya.Tween.clearAll(this),this.stopPlayMusicBg(),this.openGameEndView(),this.destroyBlockContainer()},e.prototype.UpdateScoreData=function(t,e){console.log(t+"user score "+e),0==t?c.PlayerData.Instance().setUserScore(e):c.PlayerData.Instance().setOppositeScore(e)},e.prototype.postGameOver=function(){this.isGameOver||(this.isGameOver=!0,Laya.timer.clearAll(this),Laya.Tween.clearAll(this),l.MessageProxy.Instance().SendPostScore(0),c.PlayerData.Instance().setGameResult(-1))},e.prototype.destroyBlockContainer=function(){for(var t=0;t<this.containerArr.length;t++)this.container_move.removeChild(this.containerArr[t]),this.containerArr[t].onDestory(),Laya.Pool.recover("container",this.containerArr[t]);this.containerArr=[]},e.prototype.onDestory=function(){console.log("GameMainView onDestory"),this.destroy(),this.removeSelf()},e}(i.ui.GameMainUI);o.default=d},{"../Main":2,"../MessageProxy":3,"../model/BlockContainer":4,"../model/BlockItem":5,"../model/PlayerData":6,"../ui/layaMaxUI":7,"../utils/AniUtils":8,"../utils/MathTools":9}],12:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a,i=t("../ui/layaMaxUI"),n=t("./GameMainView"),r=t("./GameEndView");!function(t){t[t.Layer_Main=0]="Layer_Main",t[t.Layer_Over=1]="Layer_Over"}(a||(a={}));var s=function(t){function e(){var e=t.call(this)||this;return e.gameMainUI=new n.default,e.gameEndView=new r.GameEndView,e.openView(e.gameMainUI,a.Layer_Main),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.openView=function(t,e){switch(e){case a.Layer_Main:this.layer_maingame.addChild(t);break;case a.Layer_Over:this.layer_over.addChild(t),this.gameEndView.init()}},e.prototype.closeView=function(t,e){switch(t.onDestory(),e){case a.Layer_Main:this.layer_maingame.destroyChildren();break;case a.Layer_Over:this.layer_over.destroyChildren(),this.onDestory()}},e.prototype.onDestory=function(){this.removeSelf(),this.destroy()},e}(i.ui.RootViewUI);o.RootView=s},{"../ui/layaMaxUI":7,"./GameEndView":10,"./GameMainView":11}]},{},[2]);